<!-- Advice Status Checker Designer -->
<div class="advice-status-checker-designer">
    
    <div data-bind="widgetChrome:{ icon: 'fa-search', title: 'Advice Status Checker Configuration' }">
        <!-- Info Button -->
        <div class="chrome-header-actions" style="float: right; margin-top: -30px; margin-right: 10px;">
            <button type="button" class="btn btn-link btn-sm info-button" 
                    data-bind="click: showInfo" 
                    title="Show detailed information about this workflow action">
                <i class="fa fa-info-circle text-info"></i>
            </button>
        </div>
        <p class="help-block">
            <i class="fa fa-info-circle"></i>
            This action checks the advice status for a work item and branches to either "Advice Running" or "Advice Paused".
            Configure which variables to use for input and output.
        </p>
        
        <!-- Work Item ID Input -->
        <div class="form-group">
            <label>Work Item ID: <span class="text-danger">*</span></label>
            <!-- ko component: { name: "core-wf-variable-selector", params: action.ui.workItemIdVariable } -->
            <!-- /ko -->
            <div class="help-block">Variable containing the work item ID to check</div>
            <!-- ko if: action.validation.workItemIdVariable -->
            <div class="text-danger">
                <i class="fa fa-exclamation-triangle"></i>
                <span data-bind="text: action.validation.workItemIdVariable"></span>
            </div>
            <!-- /ko -->
        </div>
    </div>
    
    <div data-bind="widgetChrome:{ icon: 'fa-arrow-right', title: 'Output Variables (Optional)' }">
        <p class="help-block">Configure which variables to populate with advice information:</p>
        
        <!-- Status Variable -->
        <div class="form-group">
            <label>Status Text:</label>
            <!-- ko component: { name: "core-wf-variable-selector", params: action.ui.statusVariable } -->
            <!-- /ko -->
            <div class="help-block">Will contain "active" or "paused"</div>
        </div>
        
        <!-- Is Enabled Variable -->
        <div class="form-group">
            <label>Is Enabled:</label>
            <!-- ko component: { name: "core-wf-variable-selector", params: action.ui.isEnabledVariable } -->
            <!-- /ko -->
            <div class="help-block">Boolean: true if advice is running, false if paused</div>
        </div>
        
        <!-- Pause Information -->
        <div class="form-group">
            <label>Paused Date:</label>
            <!-- ko component: { name: "core-wf-variable-selector", params: action.ui.pausedDateVariable } -->
            <!-- /ko -->
            <div class="help-block">ISO date when advice was paused (if applicable)</div>
        </div>
        
        <div class="form-group">
            <label>Paused By:</label>
            <!-- ko component: { name: "core-wf-variable-selector", params: action.ui.pausedByVariable } -->
            <!-- /ko -->
            <div class="help-block">Name of user who paused advice</div>
        </div>
        
        <div class="form-group">
            <label>Pause Reason:</label>
            <!-- ko component: { name: "core-wf-variable-selector", params: action.ui.pauseReasonVariable } -->
            <!-- /ko -->
            <div class="help-block">Reason provided when advice was paused</div>
        </div>
        
        <!-- Resume Information -->
        <div class="form-group">
            <label>Resumed Date:</label>
            <!-- ko component: { name: "core-wf-variable-selector", params: action.ui.resumedDateVariable } -->
            <!-- /ko -->
            <div class="help-block">ISO date when advice was last resumed</div>
        </div>
        
        <div class="form-group">
            <label>Resumed By:</label>
            <!-- ko component: { name: "core-wf-variable-selector", params: action.ui.resumedByVariable } -->
            <!-- /ko -->
            <div class="help-block">Name of user who resumed advice</div>
        </div>
        
        <div class="form-group">
            <label>Resume Reason:</label>
            <!-- ko component: { name: "core-wf-variable-selector", params: action.ui.resumeReasonVariable } -->
            <!-- /ko -->
            <div class="help-block">Reason provided when advice was resumed</div>
        </div>
        
        <!-- Next Advice Date -->
        <div class="form-group">
            <label>Next Advice Date:</label>
            <!-- ko component: { name: "core-wf-variable-selector", params: action.ui.nextAdviceDateVariable } -->
            <!-- /ko -->
            <div class="help-block">ISO date when next advice is scheduled</div>
        </div>
        
        <!-- Error Message Variable -->
        <div class="form-group">
            <label>Error Message:</label>
            <!-- ko component: { name: "core-wf-variable-selector", params: action.ui.errorMessageVariable } -->
            <!-- /ko -->
            <div class="help-block">Will contain error message if the check fails</div>
        </div>
    </div>
    
    <div data-bind="widgetChrome:{ icon: 'fa-code-fork', title: 'Output Branches' }">
        <div class="alert alert-info">
            <ul class="list-unstyled">
                <li><span class="label label-success">Advice Running</span> - Advice is currently active/enabled</li>
                <li><span class="label label-warning">Advice Paused</span> - Advice is currently paused/disabled</li>
                <li><span class="label label-danger">Error</span> - Failed to check advice status</li>
            </ul>
        </div>
    </div>
    
    <!-- Information Modal -->
    <!-- ko if: infoModal -->
    <!-- ko with: infoModal -->
    <div class="modal workflow-action-info-modal" data-bind="visible: isVisible, event: { keypress: handleKeyPress }" style="display: none;" tabindex="-1">
        <div class="modal-backdrop" data-bind="click: hide"></div>
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <div class="modal-title-section">
                        <i class="fa fa-info-circle text-info modal-icon"></i>
                        <h4 class="modal-title" data-bind="text: actionInfo.name || 'Workflow Action Information'"></h4>
                        <span class="badge badge-primary" data-bind="text: actionInfo.category || 'Workflow'"></span>
                    </div>
                    <button type="button" class="close" data-bind="click: hide" title="Close Information">
                        <span>&times;</span>
                    </button>
                </div>
                <div class="modal-nav">
                    <ul class="nav nav-tabs" role="tablist">
                        <!-- ko foreach: availableTabs -->
                        <li class="nav-item">
                            <a class="nav-link" 
                               data-bind="css: { active: $parent.currentTab() === id }, click: function() { $parent.switchTab(id); }"
                               href="#" role="tab">
                                <i class="fa" data-bind="css: icon"></i>
                                <span data-bind="text: title"></span>
                            </a>
                        </li>
                        <!-- /ko -->
                    </ul>
                </div>
                <div class="modal-body">
                    <div class="tab-content" data-bind="visible: currentTab() === 'overview'">
                        <div class="info-section">
                            <h5><i class="fa fa-info-circle"></i> Description</h5>
                            <p data-bind="text: actionInfo.description || 'No description available.'"></p>
                            
                            <!-- ko if: actionInfo.purpose -->
                            <h5><i class="fa fa-target"></i> Purpose</h5>
                            <p data-bind="text: actionInfo.purpose"></p>
                            <!-- /ko -->
                            
                            <!-- ko if: actionInfo.useCases && actionInfo.useCases.length > 0 -->
                            <h5><i class="fa fa-lightbulb-o"></i> Use Cases</h5>
                            <ul class="use-cases-list">
                                <!-- ko foreach: actionInfo.useCases -->
                                <li data-bind="text: $data"></li>
                                <!-- /ko -->
                            </ul>
                            <!-- /ko -->
                        </div>
                    </div>
                    
                    <div class="tab-content" data-bind="visible: currentTab() === 'configuration'">
                        <!-- ko if: getConfigurationParameters().length > 0 -->
                        <div class="info-section">
                            <h5><i class="fa fa-cogs"></i> Configuration Parameters</h5>
                            <div class="table-responsive">
                                <table class="table table-striped table-sm">
                                    <thead>
                                        <tr>
                                            <th>Parameter</th>
                                            <th>Type</th>
                                            <th>Required</th>
                                            <th>Default</th>
                                            <th>Description</th>
                                        </tr>
                                    </thead>
                                    <tbody data-bind="foreach: getConfigurationParameters">
                                        <tr>
                                            <td><code data-bind="text: name"></code></td>
                                            <td><span class="badge badge-secondary" data-bind="text: type"></span></td>
                                            <td>
                                                <i class="fa" data-bind="css: { 'fa-check text-success': required, 'fa-times text-muted': !required }"></i>
                                            </td>
                                            <td><code data-bind="text: default"></code></td>
                                            <td data-bind="text: description"></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <!-- /ko -->
                    </div>
                    
                    <div class="tab-content" data-bind="visible: currentTab() === 'examples'">
                        <!-- ko if: getUsageExamples().length > 0 -->
                        <!-- ko foreach: getUsageExamples -->
                        <div class="example-section">
                            <h5>
                                <i class="fa fa-code"></i>
                                <span data-bind="text: title"></span>
                            </h5>
                            <p><strong>Scenario:</strong> <span data-bind="text: scenario"></span></p>
                            <div class="code-example">
                                <div class="code-header">
                                    <span>Configuration</span>
                                </div>
                                <pre><code data-bind="text: JSON.stringify(configuration, null, 2)"></code></pre>
                            </div>
                            <p><strong>Expected Result:</strong> <span data-bind="text: expected"></span></p>
                        </div>
                        <!-- /ko -->
                        <!-- /ko -->
                    </div>
                    
                    <div class="tab-content" data-bind="visible: currentTab() === 'debugging'">
                        <div class="info-section">
                            <h5><i class="fa fa-bug"></i> Debugging Information</h5>
                            <div class="debug-tools">
                                <h6>Debug URL</h6>
                                <p>Use this URL to enable detailed logging:</p>
                                <div class="input-group">
                                    <input type="text" class="form-control" readonly data-bind="value: getDebugUrl">
                                    <div class="input-group-append">
                                        <button type="button" class="btn btn-outline-secondary" 
                                                data-bind="click: function() { copyToClipboard(getDebugUrl()); }"
                                                title="Copy debug URL">
                                            <i class="fa fa-copy"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="tab-content" data-bind="visible: currentTab() === 'troubleshooting'">
                        <!-- ko if: getTroubleshootingScenarios().length > 0 -->
                        <!-- ko foreach: getTroubleshootingScenarios -->
                        <div class="troubleshooting-scenario">
                            <h5>
                                <i class="fa fa-exclamation-triangle text-warning"></i>
                                <span data-bind="text: problem"></span>
                            </h5>
                            <!-- ko if: symptoms.length > 0 -->
                            <div class="scenario-section">
                                <h6><i class="fa fa-eye"></i> Symptoms</h6>
                                <ul data-bind="foreach: symptoms">
                                    <li data-bind="text: $data"></li>
                                </ul>
                            </div>
                            <!-- /ko -->
                            <!-- ko if: solutions.length > 0 -->
                            <div class="scenario-section">
                                <h6><i class="fa fa-wrench"></i> Solutions</h6>
                                <ol data-bind="foreach: solutions">
                                    <li data-bind="text: $data"></li>
                                </ol>
                            </div>
                            <!-- /ko -->
                        </div>
                        <!-- /ko -->
                        <!-- /ko -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bind="click: hide">
                        <i class="fa fa-times"></i> Close
                    </button>
                </div>
            </div>
        </div>
    </div>
    <!-- /ko -->
    <!-- /ko -->
    
</div>